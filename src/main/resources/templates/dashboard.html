<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}"/>
</head>
<body>
<nav class="header-navigation" role="navigation" aria-label="Navigation principale">
    <div class="logo" aria-label="Accueil Pay My Buddy">Pay My Buddy</div>
    <div class="items">
        <a th:href="@{/dashboard}" class="transferer active" aria-current="page">Transférer</a>
        <a th:href="@{/profile}" class="profil">Profil</a>
        <a th:href="@{/relation}" class="ajouter-relation">Ajouter relation</a>
        <form id="logoutForm" th:action="@{/logout}" method="post" style="display:inline;">
            <button type="submit" class="nav-link" aria-label="Se déconnecter" style="background:none;border:none;padding:0;cursor:pointer;">Se déconnecter</button>
        </form>
    </div>
</nav>

<h1 class="main-title">Tableau de bord</h1>

<output th:if="${successMessage}" class="alert-message alert-success" aria-live="polite">
    <span th:text="${successMessage} ?: 'Opération effectuée avec succès.'"></span>
</output>
<output th:if="${errorMessage}" class="alert-message alert-error" aria-live="assertive">
    <span th:text="${errorMessage} ?: 'Une erreur est survenue.'"></span>
</output>

<form class="transfer-zone" method="post" th:action="@{/transfer}" aria-label="Formulaire de transfert d'argent">
    <div class="transfer-label-group">
        <label for="contactEmail">Sélectionner une relation</label>
        <select class="dropdown-contact large-select" id="contactEmail" name="contactEmail" required aria-required="true">
            <option value="" disabled th:selected="${contactEmail == null}">Sélectionner une relation</option>
            <option th:each="contact : ${contacts}" th:value="${contact.email}" th:text="${contact.fullName}"></option>
        </select>
    </div>
    <div class="transfer-label-group">
        <label for="description">Description</label>
        <input type="text" class="input-description" id="description" name="description" placeholder="Description" maxlength="255" required aria-required="true">
    </div>
    <div class="transfer-label-group">
        <label for="amount">Montant</label>
        <div class="amount-input-group">
            <input type="number" class="input-montant" id="amount" name="amount" placeholder="Montant" min="1" step="1" required aria-required="true">
        </div>
    </div>
    <button class="button-transfer blue-btn" type="submit" aria-label="Payer">
        <span>Payer</span>
    </button>
</form>

<section class="table" aria-label="Historique des transactions">
    <h2 class="title">Mes transactions</h2>
    <div class="table-header">
        <div class="relations">Relations</div>
        <div class="description">Description</div>
        <div class="montant">Montant</div>
    </div>
    <div class="list">
        <div class="transaction" th:each="transaction : ${transactions}">
            <div class="contact" th:text="${transaction.contactName}"></div>
            <div class="desc" th:text="${transaction.description}"></div>
            <div class="amount" th:text="${#strings.concat(transaction.amount, ' €')}"></div>
        </div>
        <div th:if="${#lists.isEmpty(transactions)}" class="no-transaction">
            Aucune transaction à afficher.
        </div>
    </div>
</section>
</body>
</html>
