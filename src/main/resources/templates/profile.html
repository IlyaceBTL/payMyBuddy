<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Profil</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/profile.css}">
    <style>
        .edit-form { display: none; margin-top: 24px; }
        .edit-btn { margin-left: 16px; }
        .form-error { color: #d32f2f; margin-bottom: 8px; }
    </style>
</head>
<body>
<nav class="header-navigation">
    <div class="logo">Pay My Buddy</div>
    <div class="items">
        <a th:href="@{/dashboard}" class="nav-link">Transférer</a>
        <a th:href="@{/profile}" class="nav-link active">Profil</a>
        <a th:href="@{/relation}" class="nav-link">Ajouter relation</a>
        <form id="logoutForm" th:action="@{/logout}" method="post" style="display:inline;">
            <a href="#" class="nav-link" onclick="document.getElementById('logoutForm').submit(); return false;">Se déconnecter</a>
        </form>
    </div>
</nav>
<div class="profile-container">
    <h2>Mon Profil</h2>
    <div class="profile-info">
        <div class="profile-row">
            <span class="profile-label">Nom :</span>
            <span class="profile-value" th:text="${user.lastName}">Nom</span>
        </div>
        <div class="profile-row">
            <span class="profile-label">Prénom :</span>
            <span class="profile-value" th:text="${user.firstName}">Prénom</span>
        </div>
        <div class="profile-row">
            <span class="profile-label">Nom d'utilisateur :</span>
            <span class="profile-value" th:text="${user.userName}">@username</span>
        </div>
        <div class="profile-row">
            <span class="profile-label">Email :</span>
            <span class="profile-value" th:text="${user.email}">nom@domain.com</span>
        </div>
        <div class="profile-row">
            <span class="profile-label">Mot de passe :</span>
            <span class="profile-value">********</span>
            <button class="edit-btn" onclick="document.querySelector('.edit-form').style.display='block';this.style.display='none';">Modifier</button>
        </div>
    </div>
    <form class="edit-form" th:action="@{/profile/edit}" th:object="${profileDto}" method="post">
        <div th:if="${#fields.hasErrors()}" class="form-error" th:errors="*{global}"></div>
        <div class="profile-row">
            <label class="profile-label" for="firstName">Prénom :</label>
            <input type="text" id="firstName" th:field="*{firstName}" th:value="${user.firstName}" required>
            <span class="form-error" th:errors="*{firstName}"></span>
        </div>
        <div class="profile-row">
            <label class="profile-label" for="lastName">Nom :</label>
            <input type="text" id="lastName" th:field="*{lastName}" th:value="${user.lastName}" required>
            <span class="form-error" th:errors="*{lastName}"></span>
        </div>
        <div class="profile-row">
            <label class="profile-label" for="userName">Nom d'utilisateur :</label>
            <input type="text" id="userName" th:field="*{userName}" th:value="${user.userName}" required>
            <span class="form-error" th:errors="*{userName}"></span>
        </div>
        <div class="profile-row">
            <label class="profile-label" for="email">Email :</label>
            <input type="email" id="email" th:field="*{email}" th:value="${user.email}" required>
            <span class="form-error" th:errors="*{email}"></span>
        </div>
        <div class="profile-row">
            <label class="profile-label" for="password">Mot de passe (pour valider) :</label>
            <input type="password" id="password" th:field="*{password}" autocomplete="current-password" required>
            <span class="form-error" th:errors="*{password}"></span>
        </div>
        <button type="submit" class="edit-btn">Enregistrer</button>
        <button type="button" class="edit-btn" onclick="document.querySelector('.edit-form').style.display='none';document.querySelector('.edit-btn').style.display='inline-block';">Annuler</button>
    </form>
</div>
</body>
</html>